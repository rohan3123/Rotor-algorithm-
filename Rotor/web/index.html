<!DOCTYPE html>
<html>
<head>
    <title>Welcome</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
    <div class="container">
        <h2>Database</h2>
        <button onclick="checkDatabaseConnection()">Check Database Connection</button>
        <button onclick="createAdmin()">Create Admin</button>
        <div id="databaseConnectionDisplay"></div>

        <div id="userList"></div>
    </div>
    
    <div class="form-container">
        <h2>Login</h2>
        <form id="loginForm">
            <label for="loginUsername">Username:</label>
            <input type="text" id="loginUsername" name="loginUsername" required>
            <br>
            <label for="loginPassword">Password:</label>
            <input type="password" id="loginPassword" name="loginPassword" required>
            <br>
            <button type="button" onclick="loginUser()">Login</button>
        </form>
        <div id="loginStatus"></div>
    </div>

    <div class="form-container">
        <h2>Registration</h2>
        <form id="registrationForm">
            <label for="regUsername">Username:</label>
            <input type="text" id="regUsername" name="regUsername" required>
            <br>
            <label for="regPassword">Password:</label>
            <input type="password" id="regPassword" name="regPassword" required>
            <br>
            <button type="button" onclick="registerUser()">Register</button>
            <div id="registrationStatus"></div>
        </form>
    </div>

    <script>
        function checkDatabaseConnection() {
            $.ajax({
                url: '/Rotor/api/orchestrator/checkDatabaseConnection',
                method: 'GET',
                success: function(response) {
                    $('#databaseConnectionDisplay').text('Database Connection Status: ' + response.status);
                },
                error: function() {
                    $('#databaseConnectionDisplay').text('Error checking database connection');
                }
            });
        }
        
        function createAdmin() {
            $.ajax({
                url: '/Rotor/api/orchestrator/createAdmin',
                method: 'POST',
                success: function(response) {
                    console.log(response);
                    // You can handle the response as needed
                },
                error: function() {
                    console.log('Error creating admin');
                }
            });
        }

        function registerUser() {
            var username = $('#regUsername').val();
            var password = $('#regPassword').val();

            $.ajax({
                url: '/Rotor/api/orchestrator/registerUser',
                method: 'POST',
                data: { username: username, password: password },
                success: function(response) {
                    $('#registrationStatus').text(response.status);
                },
                error: function() {
                    $('#registrationStatus').text('Error registering user');
                }
            });
        }

        function loginUser() {
            // Get user input for username and password
            var username = $("#loginUsername").val();
            var password = $("#loginPassword").val();

            $.ajax({
                url: '/Rotor/api/orchestrator/loginUser',
                method: 'POST',
                data: { username: username, password: password },
                success: function(response) {
                    if (response.status === "success") {
                        // Get the user ID from the response
                        var userId = response.userId;

                        // Store user ID in session storage
                        sessionStorage.setItem("userId", userId);

                        // Redirect based on user ID
                        if (userId === 12345) {
                            window.location.href = 'admin.html';
                        } else {
                            window.location.href = 'mainmenu.html';
                        }
                    } else {
                        // Display login error message
                        $('#loginStatus').text('Login failed. ' + response.status);
                    }
                },
                error: function() {
                    $('#loginStatus').text('Error logging in');
                }
            });
        }


    </script>
</body>
</html>



