<!DOCTYPE html>
<html>
<head>
    <title>Admin</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
    <div>
        <h1>Admin Page</h1>
        
        <!-- Button to view all users -->
        <button onclick="viewAllUsers()">View All Users</button>
        <button onclick="checkDatabaseConnection()">Check Database Connection</button>
        <div id="databaseConnectionDisplay"></div>
        
        <hr>
        
        <!-- Form to assign hours to a user -->
        <h2>Assign Hours to User</h2>
        <form id="assignHoursForm">
            <label for="userId">User ID:</label>
            <input type="text" id="userId" name="userId" required>
            
            <label for="hours">Hours:</label>
            <input type="number" id="hours" name="hours" required>
            
            <button type="button" onclick="assignHours()">Assign Hours</button>
        </form>

        <!-- Display area for user data -->
        <div id="userList"></div>
    </div>

    <script>
        function checkDatabaseConnection() {
            $.ajax({
                url: '/Rotor/api/orchestrator/checkDatabaseConnection',
                method: 'GET',
                success: function(response) {
                    $('#databaseConnectionDisplay').text('Database Connection Status: ' + response.status);
                },
                error: function() {
                    $('#databaseConnectionDisplay').text('Error checking database connection');
                }
            });
        }
        
        function viewAllUsers() {
            $.ajax({
                url: '/Rotor/api/orchestrator/getAllUsers',
                method: 'GET',
                success: function(response) {
                    // Handle the response and display user data on the page
                    displayUserList(response);
                },
                error: function() {
                    // Handle the error
                    console.error('Error fetching users.');
                }
            });
        }

        // Function to display user list
        function displayUserList(users) {
            // Clear existing content
            $('#userList').empty();

            // Display user data
            users.forEach(function(user) {
            $('#userList').append('<p>User ID: ' + user.id + ', Username: ' + user.username + ', Password: ' + user.password + ', Hours: ' + user.hours + '</p>');
            });
        }

        function assignHours() {
            var userId = $('#userId').val();
            var hours = $('#hours').val();

            $.ajax({
                url: '/Rotor/api/orchestrator/assignHours',
                method: 'POST',
                data: { userId: userId, hours: hours },
                success: function (response) {
                    if (response.status === 'success') {
                        alert('Hours assigned successfully');
                        // Optionally, refresh the user list or perform other actions
                    } else {
                        alert('Error assigning hours: ' + response.message);
                    }
                },
                error: function () {
                    alert('Error assigning hours');
                }
            });
        }

    </script>
</body>
</html>

